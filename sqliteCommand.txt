.mode csv
.headers on
.separator ,

.import playdata.csv playdata
.import PLAY_KIND.csv playkind

create table playdata2 as select
playdata.*, playkind.name as actionName from playdata
inner join playkind
on playdata.アクションID = playkind.アクションID;

select
試合ID as matchID,
履歴No as historyID,
試合状態ID as matchState,
絶対時間 as time,
絶対時間ミリ秒 as mtime,
チームID as teamID,
選手ID as playerID,
ホームアウェイF as homeaway,
ボールＸ as ballX,
ボールＹ as ballY,
攻撃番号 as attackNo,
"HOTZONE6-9" as hotzone,
case when アクションID = 29 then "Pass_"||展開力||"_"||F_成功
	when アクションID = 30 then "Pass_"||展開力||"_"||F_成功
	else actionName
	end  as actionWord
from playdata2;

